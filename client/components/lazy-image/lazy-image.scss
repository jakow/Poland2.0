// The maps to define ratios
// use the map as (numerator: denominator[])

$predef-ratios: (
  1 : (1,),
  3 : (2,),
  5 : (4,),
  16 : (9,),
);
$lazy-img-transition-duration: 0.3s;
$lazy-img-transition: $lazy-img-transition-duration ease-in;
$blur: 5px;


.lazy-img {
  // background: $color-dark;
  position: relative;
  overflow: hidden;
  // will have clip border radius
  .preview, .original {
    // instead of positioning with top: 0 and left: 0 we can restrict the image height artificially,
    // while also maintaining the height
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    // respect max-height of parent
    max-height: inherit;
    // fill parent - important for the placeholders which otherwise will respect their natural (small) size
    width: 100%;
    opacity: 0;
  // opacity animation
    will-change: opacity;
    transition: opacity $lazy-img-transition;
  }

  // add a blur to the preview
  .preview {
    filter: blur($blur);
  }

  &.preview-loaded {
    .preview {
      opacity: 1;
    }
  }

  &.loaded {
    .original {
      opacity: 1;
    }
    .preview {
      // hide after original in view - mostly for ARIA purposes rather than visual presentation
      // because preview is covered by original anyway
      transition: visibility 0s linear $lazy-img-transition-duration;
      visibility: hidden;
    }
    .spinner-container {
      opacity: 0;
    }
    .spinner {
      transition-delay: $lazy-img-transition-duration;
      visibility: hidden;
    }
  }

  noscript .original {
    z-index: 4;
    opacity: 1;
    visibility: visible;
  }
  
  // handle predefined padding for lazy images
  @each $numerator, $denominators in $predef-ratios {
    @each $denominator in $denominators {
      .ratio-#{$numerator}-to-#{$denominator} {
        // display: inline-block;
        padding-bottom: percentage($denominator/$numerator);
      }
    }
  }
}




