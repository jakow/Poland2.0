include ../../components/modal/modal
include ../../components/lazy-image/lazy-image



mixin sponsor-list(sponsorCategories)
  ol.sponsor-category__list
    each category in sponsorCategories
      li.sponsor-category
        - const categoryName = slugify(category.name);
        - const categoryClass = 'sponsor-list--' + categoryName;
        +category-inline-style(category)
        if (category.showName)
          h2=(category.sponsors.length > 1 ? category.name : category.singular)
        ul.sponsor-list(class=`sponsor-list--${category.perColumn}-col ${categoryClass}`)
          each sponsor in category.sponsors
            li: +sponsor(sponsor)


mixin sponsors(sponsorCategories)
  if sponsorCategories
    div.center
      h2.bold.heading-stripe Partners
    +sponsor-list(sponsorCategories)


mixin previous-sponsors(sponsorCategories)
  if sponsorCategories && sponsorCategories.length
    div.center
      h2.bold.fat-heading.heading-stripe Previous Partners
      p.subtitle Previously, Poland 2.0 has partnered up with the following companies, organisations and agencies:
    +sponsor-list(sponsorCategories)

mixin sponsor(sponsor)
  - const ratio = sponsor.logo.width / sponsor.logo.height;
  - const url = imgTransform.limit(sponsor.logo.secure_url, 400);
  if sponsor.description
    - const modalId = `modal-${sponsor._id}`;
    +modalOpenButton(modalId).sponsor__link(title=`Read about ${sponsor.name}`)
      .sponsor
          +lazy-image(url, null, ratio)(alt=sponsor.name).sponsor__logo
          //- img(src=sponsor.logo.secure_url alt=sponsor.name)
          span.sr-only=sponsor.name
    +modal(modalId, `About ${sponsor.name}`)
      .simple-modal
        img.simple-modal__img(src=sponsor.logo.secure_url)
        .simple-modal__content
          header
            h4.simple-modal__heading=sponsor.name
          div!=sponsor.description
  else
    a(href=sponsor.url title=`Go to ${sponsor.name}'s webpage`).sponsor__link
      .sponsor

        +lazy-image(url, null, ratio)(alt=sponsor.name).sponsor__logo
        //- img(src=sponsor.logo.secure_url alt=sponsor.name)
        span.sr-only=sponsor.name


mixin category-inline-style(category)
  if category.imageAdjust.width || category.imageAdjust.height
    - const categoryName = slugify(category.name);
    - const categoryClass = 'sponsor-list--' + categoryName;
    - const maxWidth = category.imageAdjust.width;
    - const maxHeight = category.imageAdjust.height;
    style.
      .sponsor-list.#{categoryClass} .lazy-img { #{maxWidth  ? 'max-width: '  + maxWidth  + ';' : '' } #{maxHeight ? 'max-height: ' + maxHeight + ';' : '' }}